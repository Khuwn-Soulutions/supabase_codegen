import 'package:test/test.dart';

import '../../../../bin/src/src.dart';

void main() {
  group('writeHeader and writeFooter', () {
    test('writeHeader writes correct header', () {
      final buffer = StringBuffer();
      writeHeader(buffer);
      expect(buffer.toString(), contains('//'));
      expect(buffer.toString(), contains('Generated file. Do not edit.'));
    });

    test('writeFooter writes correct footer with tag', () {
      final buffer = StringBuffer();
      tag = 'test_tag';
      writeFooter(buffer);
      expect(buffer.toString(), contains('Generated by supabase_codegen'));
      expect(buffer.toString(), contains('Tag: test_tag'));
      expect(buffer.toString(), contains(version));
    });

    test('writeFooter writes correct footer without tag', () {
      final buffer = StringBuffer();
      tag = '';
      writeFooter(buffer);
      expect(buffer.toString(), contains('Generated by supabase_codegen'));
      expect(buffer.toString(), isNot(contains('Tag:')));
    });
  });
}
